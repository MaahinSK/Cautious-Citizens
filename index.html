<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cautious Citizens</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
  <style>
  /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.7);
    overflow: auto;
  }

  .modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 300px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    position: relative;
    animation: modalopen 0.4s;
  }

  @keyframes modalopen {
    from {opacity: 0; transform: translateY(-60px);}
    to {opacity: 1; transform: translateY(0);}
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    position: absolute;
    top: 10px;
    right: 15px;
  }

  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }

  .modal-content h2 {
    margin-top: 0;
    color: #366de4;
    text-align: center;
  }

  .modal-content input {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-sizing: border-box;
  }

  .modal-content button {
    width: 100%;
    padding: 10px;
    background-color: #366de4;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    margin-top: 10px;
  }

  .modal-content button:hover {
    background-color: #2a56c7;
  }
</style>
</head>
<body>
  <nav class="navbar">
    <div class="left">
  <a href="index.html" class="logo-link">
    <h1 class="brand">Cautious Citizens</h1>
  </a>
</div>
    <div class="center">
      <a href="admin.html">Admin</a>
      <a href="about.html">About Us</a>
      <a href="chat.html">Chat Board</a>
      <a href="profile.html">Profile</a>
      <a href="feed.html">Feed</a>
    </div>
    <div class="right" id="auth-buttons">
      <button id="loginBtn">Login</button>
      <button id="signupBtn">Sign Up</button>
    </div>
    <div class="right" id="user-info" style="display: none;">
      <span id="username-display"></span>
      <button id="logoutBtn">Logout</button>
    </div>
  </nav>
  
  <main class="main-content">
    <div class="overlay">
      <img src="assets/police checkpost.PNG" alt="Main Image" class="main-img" />
      <h2 class="main-text">Welcome to Cautious Citizens</h2>
    </div>
  </main>
  
  <section class="teams display-flex">
           <div class="team-img-container">
                <img src="assets/army cars.PNG" alt="">
                <img src="assets/army walking.PNG" alt="">
                <img src="assets/raasta bondho.PNG" alt="">
                <img src="assets/gush.PNG" alt="">
           </div>
            <div class="our-features">
                <h3 class="section-title">Quick List Of Our Features</h3>
                <p class="feature-description text-light-gray">
                    Cautious Citizens is a community-driven platform designed to enhance public safety and awareness. The website features user authentication with personalized profiles, a real-time community chat board for instant communication, and a dynamic feed where users can share safety updates, incidents, or concerns with images, locations, and descriptions. Leveraging Firebase for secure data storage and Cloudinary for image uploads, the platform ensures seamless interaction while maintaining data integrity. Additional features include achievement tracking on user profiles and responsive design for accessibility across devices. Together, these tools foster a connected and vigilant community.
                </p>
                <button class="btn-primary">Explore More</button>
            </div>
        </section>

  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeLogin">&times;</span>
      <h2>Login</h2>
      <input type="email" id="loginEmail" placeholder="Email" />
      <input type="password" id="loginPassword" placeholder="Password" />
      <button id="submitLogin">Login</button>
    </div>
  </div>

  <div id="signupModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeSignup">&times;</span>
      <h2>Sign Up</h2>
      <input type="email" id="signupEmail" placeholder="Email" />
      <input type="password" id="signupPassword" placeholder="Password" />
      <button id="submitSignup">Sign Up</button>
    </div>
  </div>

  <script src="firebase-config.js"></script>
  <script>
    // Firebase Auth State Listener
    auth.onAuthStateChanged((user) => {
      if (user) {
        document.getElementById("auth-buttons").style.display = "none";
        document.getElementById("user-info").style.display = "flex";
        db.collection("users").doc(user.uid).get().then(doc => {
          const name = doc.exists && doc.data().name ? doc.data().name : user.email;
          document.getElementById("username-display").innerText = name;
        });
      }
    });

    // Modal handling
    const loginModal = document.getElementById("loginModal");
    const signupModal = document.getElementById("signupModal");
    
    // Login button event listener
    document.getElementById("loginBtn").addEventListener("click", () => {
      loginModal.style.display = "block";
    });
    
    // Signup button event listener
    document.getElementById("signupBtn").addEventListener("click", () => {
      signupModal.style.display = "block";
    });
    
    // Close buttons event listeners
    document.getElementById("closeLogin").addEventListener("click", () => {
      loginModal.style.display = "none";
    });
    
    document.getElementById("closeSignup").addEventListener("click", () => {
      signupModal.style.display = "none";
    });
    
    // Close modal when clicking outside
    window.addEventListener("click", (event) => {
      if (event.target === loginModal) {
        loginModal.style.display = "none";
      }
      if (event.target === signupModal) {
        signupModal.style.display = "none";
      }
    });

    // Signup functionality
    document.getElementById("submitSignup").addEventListener("click", () => {
      const email = document.getElementById("signupEmail").value;
      const password = document.getElementById("signupPassword").value;
      
      if (!email || !password) {
        alert("Please enter both email and password");
        return;
      }
      
      auth.createUserWithEmailAndPassword(email, password)
        .then((userCred) => {
          return db.collection("users").doc(userCred.user.uid).set({ 
            email: email,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });
        })
        .then(() => {
          alert("Account created successfully!");
          signupModal.style.display = "none";
          document.getElementById("signupEmail").value = "";
          document.getElementById("signupPassword").value = "";
        })
        .catch(error => {
          console.error("Signup error:", error);
          alert("Error creating account: " + error.message);
        });
    });

    // Login functionality
    document.getElementById("submitLogin").addEventListener("click", () => {
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;
      
      if (!email || !password) {
        alert("Please enter both email and password");
        return;
      }
      
      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          loginModal.style.display = "none";
          document.getElementById("loginEmail").value = "";
          document.getElementById("loginPassword").value = "";
        })
        .catch(error => {
          console.error("Login error:", error);
          alert("Error signing in: " + error.message);
        });
    });

    // Logout functionality
    document.getElementById("logoutBtn").addEventListener("click", () => {
      auth.signOut().then(() => {
        alert("Logged out successfully");
        location.reload();
      });
    });

    // Highlight active page in navigation
    document.addEventListener('DOMContentLoaded', function() {
      const currentPage = window.location.pathname.split('/').pop();
      const navLinks = document.querySelectorAll('.navbar .center a');
      
      navLinks.forEach(link => {
        const linkPage = link.getAttribute('href');
        if (linkPage === currentPage || (currentPage === '' && linkPage === 'index.html')) {
          link.classList.add('active');
        }
      });
    });
  </script>
</body>
</html>